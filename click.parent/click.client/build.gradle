buildscript {
  repositories {
    maven {
      url "https://plugins.gradle.org/m2/"
      //url System.getenv('GG_REPO')
    }
  }

  dependencies {
    classpath "com.moowork.gradle:gradle-node-plugin:0.12"
  }
}

apply plugin: 'com.moowork.node'

task cleanLibs(type: Delete) {
  delete 'node_modules', 'www/lib', 'cordova/www', 'cordova/plugins', 'cordova/platforms', 'cordova/res', 'cordova/node_modules'
}

clean.dependsOn cleanLibs

dependencies {
  testCompile 'kz.greetgo.cordosencha:cordosencha.gradle:0.0.6'
}

task prepareCordovaStandWWW(type: JavaExec, group: 'client_inner') {
  dependsOn npmInstall
  classpath { [sourceSets.test.runtimeClasspath] }

  main = 'kz.greetgo.click.client.PrepareCordovaWWW'
  args = [
    '-indexName', 'index-stand.html',
    '-copyDir', 'stand',
    '-copyDir', 'lib',
    '-copyDir', 'css',
    '-copyDir', 'js',
    '-copyDir', 'resources',
    '-copyNoReplace', 'cordova/www_cordova', 'cordova/www'
  ]
}

task prepareCordovaProductionWWW(type: JavaExec, group: 'client_inner') {
  dependsOn npmInstall
  classpath { [sourceSets.test.runtimeClasspath] }

  main = 'kz.greetgo.click.client.PrepareCordovaWWW'
  args = [
    '-indexName', 'index-production.html',
    '-copyDir', 'stand',
    '-copyDir', 'lib',
    '-copyDir', 'css',
    '-copyDir', 'js',
    '-copyDir', 'resources',
    '-copyNoReplace', 'cordova/www_cordova', 'cordova/www'
  ]
}

task compileAndroidStand(type: JavaExec, group: 'client') {
  dependsOn prepareCordovaStandWWW
  classpath { [sourceSets.test.runtimeClasspath] }

  main = 'kz.greetgo.click.client.CompileCordovaAndroid'
  args = []
}
task compileAndroidProduction(type: JavaExec, group: 'client') {
  dependsOn prepareCordovaProductionWWW
  classpath { [sourceSets.test.runtimeClasspath] }

  main = 'kz.greetgo.click.client.CompileCordovaAndroid'
  args = []


}



task compileIosStand(type: JavaExec, group: 'client') {
  dependsOn prepareCordovaStandWWW
  classpath { [sourceSets.test.runtimeClasspath] }

  main = 'kz.greetgo.click.client.CompileCordovaIos'
  args = []
}
task compileIosProduction(type: JavaExec, group: 'client') {
  dependsOn prepareCordovaProductionWWW
  classpath { [sourceSets.test.runtimeClasspath] }

  main = 'kz.greetgo.click.client.CompileCordovaIos'
  args = []
}
